<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SocialHub</title>
  <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-dark.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
  <style>
    :root { --bg: #000; --text: #fff; --accent: #ff0000; --glass: rgba(255,0,0,0.15); --border: rgba(255,0,0,0.3); }
    .dark { --bg: #0a0a0a; --glass: rgba(255,0,0,0.1); }
    body { background: var(--bg); color: var(--text); font-family: 'Inter', sans-serif; transition: 0.4s; }
    .glass { backdrop-filter: blur(20px); background: var(--glass); border: 1px solid var(--border); }
    .card { transition: all 0.4s; }
    .card:hover { transform: translateY(-12px); box-shadow: 0 40px 80px rgba(255,0,0,0.5); }
    .bento { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 2rem; }
    .feed { height: 100vh; overflow-y: scroll; scroll-snap-type: y mandatory; }
    .video-item { scroll-snap-align: start; height: 100vh; position: relative; }
    video { width: 100%; height: 100%; object-fit: contain; background: #111; }
    .online { width: 12px; height: 12px; background: #0f0; border-radius: 50%; }
    .notification { position: fixed; top: 20px; right: 20px; background: #ff0000; color: white; padding: 12px 20px; border-radius: 12px; z-index: 1000; animation: slide 0.3s; }
    @keyframes slide { from { transform: translateX(100%); } to { transform: translateX(0); } }
  </style>
</head>
<body class="min-h-screen">

  <!-- AUTH -->
  <div id="auth" class="fixed inset-0 bg-black flex items-center justify-center z-50">
    <div class="glass p-8 rounded-3xl w-96">
      <h2 class="text-3xl font-black mb-6 bg-gradient-to-r from-red-500 to-red-600 bg-clip-text text-transparent">SocialHub</h2>
      <input id="regEmail" placeholder="Email" class="w-full p-4 rounded-2xl mb-4 glass" />
      <input id="regPass" type="password" placeholder="Password" class="w-full p-4 rounded-2xl mb-4 glass" />
      <button onclick="register()" class="w-full py-4 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-2xl mb-2">Register</button>
      <button onclick="showLogin()" class="w-full py-4 bg-gray-700 text-white rounded-2xl">Login</button>
      <input id="codeInput" placeholder="Verification Code" class="w-full p-4 rounded-2xl mt-4 glass hidden" />
      <button id="verifyBtn" onclick="verify()" class="w-full py-4 bg-red-600 text-white rounded-2xl mt-2 hidden">Verify</button>
    </div>
  </div>

  <!-- LOGIN -->
  <div id="loginModal" class="hidden fixed inset-0 bg-black flex items-center justify-center z-50">
    <div class="glass p-8 rounded-3xl w-96">
      <input id="loginEmail" placeholder="Email" class="w-full p-4 rounded-2xl mb-4 glass" />
      <input id="loginPass" type="password" placeholder="Password" class="w-full p-4 rounded-2xl mb-4 glass" />
      <button onclick="login()" class="w-full py-4 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-2xl">Login</button>
    </div>
  </div>

  <!-- MAIN APP -->
  <div id="app" class="hidden">
    <!-- NAVBAR -->
    <nav class="glass fixed top-0 w-full z-50 p-4">
      <div class="max-w-7xl mx-auto flex justify-between items-center">
        <h1 class="text-3xl font-black bg-gradient-to-r from-red-500 to-red-600 bg-clip-text text-transparent">SocialHub</h1>
        <div class="flex gap-3">
          <button onclick="show('feed')" class="px-5 py-2 rounded glass">Feed</button>
          <button onclick="show('hub')" class="px-5 py-2 rounded glass">Hub</button>
          <button onclick="show('chat')" class="px-5 py-2 rounded glass">Chat</button>
          <button onclick="show('profile')" class="px-5 py-2 rounded bg-gradient-to-r from-red-500 to-red-600 text-white">Me</button>
          <button onclick="toggleDark()" class="p-2 rounded glass">Toggle</button>
        </div>
      </div>
    </nav>

    <!-- VIDEO FEED -->
    <div id="feed" class="feed pt-20 hidden">
      <div id="videoGrid"></div>
    </div>

    <!-- HUB (OLD CONTENT) -->
    <div id="hub" class="hidden pt-32 max-w-7xl mx-auto px-6">
      <div class="flex justify-between mb-6">
        <h2 class="text-5xl font-black bg-gradient-to-r from-red-500 to-red-600 bg-clip-text text-transparent">Content Hub</h2>
        <button onclick="showUpload()" class="px-6 py-3 bg-red-600 text-white rounded-xl">+</button>
      </div>
      <div id="contentGrid" class="bento"></div>
    </div>

    <!-- CHAT -->
    <div id="chat" class="hidden pt-32 max-w-7xl mx-auto px-6 flex gap-6">
      <div class="flex-1">
        <h2 class="text-4xl font-black mb-4">Global Chat</h2>
        <div id="globalChat" class="h-96 overflow-y-auto glass p-4 mb-4"></div>
        <input id="globalMsg" placeholder="Type message... (Enter to send)" class="w-full p-3 rounded glass" onkeydown="handleEnter(event)" />
      </div>
      <div class="w-80">
        <input id="searchUsers" placeholder="Find Player..." class="w-full p-3 rounded glass mb-4" onkeyup="searchUsers()" />
        <div id="onlineUsers" class="space-y-2"></div>
      </div>
    </div>

    <!-- PROFILE -->
    <div id="profile" class="hidden pt-32 max-w-4xl mx-auto px-6">
      <div class="glass p-8 rounded-3xl">
        <div class="flex items-center gap-6 mb-6">
          <img id="avatar" src="" class="w-32 h-32 rounded-full" />
          <div>
            <h2 id="profileName" class="text-4xl font-black"></h2>
            <p id="profileEmail" class="text-lg opacity-80"></p>
            <p id="adminBadge" class="text-sm text-yellow-400 font-bold hidden">ADMIN</p>
          </div>
        </div>
        <button onclick="showSettings()" class="px-6 py-3 bg-red-600 text-white rounded-xl">Edit</button>
      </div>
    </div>

    <!-- UPLOAD MODAL -->
    <div id="uploadModal" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-50">
      <div class="glass p-10 rounded-3xl w-full max-w-2xl">
        <select id="uploadType" class="p-4 rounded-2xl w-full mb-4 glass">
          <option value="video">Video (MP4)</option>
          <option value="game">Game (HTML)</option>
          <option value="script">Script</option>
        </select>
        <input id="uploadTitle" placeholder="Title" class="p-4 rounded-2xl w-full mb-4 glass" />
        <input type="file" id="uploadFile" class="p-4 rounded-2xl w-full mb-4 glass" />
        <button onclick="upload()" class="w-full py-4 bg-red-600 text-white rounded-2xl">Upload</button>
      </div>
    </div>

    <!-- SETTINGS -->
    <div id="settingsModal" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-50">
      <div class="glass p-8 rounded-3xl w-full max-w-md">
        <input id="setName" placeholder="Name" class="p-3 rounded w-full mb-3 glass" />
        <input type="file" id="setAvatar" class="mb-3" />
        <button onclick="saveProfile()" class="w-full py-3 bg-red-600 text-white rounded">Save</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
  <script>
    let users = JSON.parse(localStorage.getItem('users') || '{}');
    let content = JSON.parse(localStorage.getItem('content') || '[]');
    let messages = JSON.parse(localStorage.getItem('messages') || '[]');
    let me = {};

    // AUTH
    function register() {
      const email = document.getElementById('regEmail').value;
      const pass = document.getElementById('regPass').value;
      if (!email || !pass) return alert('Fill all');
      const code = Math.floor(100000 + Math.random() * 900000);
      users[email] = { email, pass, name: email.split('@')[0], avatar: '', verified: false, isAdmin: email === 'pdigger48@gmail.com' };
      localStorage.setItem('users', JSON.stringify(users));
      alert(`Verification Code: ${code} (Check Gmail in real app)`);
      document.getElementById('codeInput').classList.remove('hidden');
      document.getElementById('verifyBtn').classList.remove('hidden');
      window.verifyCode = code;
    }

    function verify() {
      const code = document.getElementById('codeInput').value;
      const email = document.getElementById('regEmail').value;
      if (code == window.verifyCode) {
        users[email].verified = true;
        localStorage.setItem('users', JSON.stringify(users));
        alert('Verified!');
        showLogin();
      }
    }

    function showLogin() {
      document.getElementById('auth').classList.add('hidden');
      document.getElementById('loginModal').classList.remove('hidden');
    }

    function login() {
      const email = document.getElementById('loginEmail').value;
      const pass = document.getElementById('loginPass').value;
      const user = users[email];
      if (user && user.pass === pass && user.verified) {
        me = user;
        localStorage.setItem('me', email);
        document.getElementById('loginModal').classList.add('hidden');
        document.getElementById('app').classList.remove('hidden');
        init();
      } else alert('Invalid');
    }

    function init() {
      document.getElementById('profileName').innerText = me.name;
      document.getElementById('profileEmail').innerText = me.email;
      document.getElementById('avatar').src = me.avatar || 'https://via.placeholder.com/120';
      if (me.isAdmin) document.getElementById('adminBadge').classList.remove('hidden');
      renderFeed();
      renderContent();
      renderOnline();
    }

    function show(page) {
      ['feed','hub','chat','profile'].forEach(id => document.getElementById(id).classList.add('hidden'));
      document.getElementById(page).classList.remove('hidden');
      if (page === 'feed') renderFeed();
      if (page === 'hub') renderContent();
      if (page === 'chat') renderGlobalChat();
    }

    function renderFeed() {
      const grid = document.getElementById('videoGrid');
      grid.innerHTML = '';
      content.filter(c => c.type === 'video').forEach(v => {
        const div = document.createElement('div');
        div.className = 'video-item';
        div.innerHTML = `
          <video src="${v.content}" loop autoplay muted></video>
          <div class="absolute bottom-4 left-4 text-white">
            <p class="font-bold text-xl">${v.title}</p>
            <p>by ${v.user}</p>
          </div>
        `;
        grid.appendChild(div);
      });
    }

    function upload() {
      const type = document.getElementById('uploadType').value;
      const title = document.getElementById('uploadTitle').value;
      const file = document.getElementById('uploadFile').files[0];
      const reader = new FileReader();
      reader.onload = (e) => {
        const item = { id: Date.now(), type, title, content: type === 'video' ? URL.createObjectURL(file) : e.target.result, user: me.name };
        content.push(item);
        localStorage.setItem('content', JSON.stringify(content));
        document.getElementById('uploadModal').classList.add('hidden');
        renderFeed();
        renderContent();
      };
      reader.readAsText(file);
    }

    function handleEnter(e) {
      if (e.key === 'Enter') {
        e.preventDefault();
        sendGlobal();
      }
    }

    function sendGlobal() {
      const msg = document.getElementById('globalMsg').value.trim();
      if (msg) {
        messages.push({ type: 'global', user: me.name, msg, time: new Date().toLocaleTimeString() });
        document.getElementById('globalMsg').value = '';
        localStorage.setItem('messages', JSON.stringify(messages));
        renderGlobalChat();
      }
    }

    function renderGlobalChat() {
      const chat = document.getElementById('globalChat');
      chat.innerHTML = messages.filter(m => m.type === 'global').map(m => `<div class="mb-2"><strong>${m.user}</strong>: ${m.msg}</div>`).join('');
      chat.scrollTop = chat.scrollHeight;
    }

    function searchUsers() {
      const query = document.getElementById('searchUsers').value.toLowerCase();
      const list = document.getElementById('onlineUsers');
      list.innerHTML = Object.keys(users).filter(u => u.toLowerCase().includes(query) && users[u].verified).map(u => `
        <div class="glass p-3 rounded flex justify-between">
          <span>${u}</span>
          <button onclick="dm('${u}')" class="text-xs text-red-400">DM</button>
        </div>
      `).join('');
    }

    function dm(user) {
      const msg = prompt(`Message to ${user}:`);
      if (msg) notify(`DM sent to ${user}`);
    }

    function renderOnline() {
      setInterval(() => {
        document.getElementById('onlineUsers').innerHTML = Object.keys(users).filter(u => users[u].verified).map(u => `
          <div class="glass p-3 rounded flex justify-between">
            <span><span class="online inline-block mr-2"></span>${u}</span>
            <button onclick="dm('${u}')" class="text-xs text-red-400">DM</button>
          </div>
        `).join('');
      }, 5000);
    }

    function showSettings() {
      document.getElementById('setName').value = me.name;
      document.getElementById('settingsModal').classList.remove('hidden');
    }

    function saveProfile() {
      me.name = document.getElementById('setName').value;
      const file = document.getElementById('setAvatar').files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = (e) => { me.avatar = e.target.result; save(); };
        reader.readAsDataURL(file);
      } else save();
    }

    function save() {
      users[me.email] = me;
      localStorage.setItem('users', JSON.stringify(users));
      document.getElementById('settingsModal').classList.add('hidden');
      init();
    }

    function notify(msg) {
      const n = document.createElement('div');
      n.className = 'notification';
      n.innerText = msg;
      document.body.appendChild(n);
      setTimeout(() => n.remove(), 3000);
    }

    function toggleDark() { document.body.classList.toggle('dark'); }

    // INIT
    const saved = localStorage.getItem('me');
    if (saved && users[saved]) {
      me = users[saved];
      document.getElementById('auth').classList.add('hidden');
      document.getElementById('app').classList.remove('hidden');
      init();
    }
  </script>
</body>
</html>
