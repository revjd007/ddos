<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AI Hub</title>
  <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@tabler/icons-webfont@2.44.0/dist/tabler-icons.min.css" rel="stylesheet">
  <style>
    :root { --bg: #f8f9ff; --text: #1a1a2e; --glass: rgba(255,255,255,0.15); --border: rgba(255,255,255,0.25); }
    .dark { --bg: #0f0f1a; --text: #e0e0ff; --glass: rgba(20,20,40,0.6); --border: rgba(100,100,255,0.2); }
    body { background: var(--bg); color: var(--text); font-family: 'Inter', sans-serif; transition: all 0.4s; }
    .glass { backdrop-filter: blur(16px); background: var(--glass); border: 1px solid var(--border); }
    .gradient { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    .card { transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1); }
    .card:hover { transform: translateY(-8px) scale(1.02); box-shadow: 0 30px 60px rgba(0,0,0,0.2); }
    .chat-bubble { max-width: 80%; padding: 12px 18px; border-radius: 18px; margin: 8px 0; }
    .user { background: #667eea; color: white; align-self: flex-end; }
    .ai { background: rgba(255,255,255,0.1); border: 1px solid var(--border); }
    .typing { display: flex; gap: 4px; }
    .dot { width: 8px; height: 8px; background: #aaa; border-radius: 50%; animation: pulse 1.5s infinite; }
    @keyframes pulse { 0%, 100% { opacity: 0.4; } 50% { opacity: 1; } }
    .dot:nth-child(2) { animation-delay: 0.2s; }
    .dot:nth-child(3) { animation-delay: 0.4s; }
  </style>
</head>
<body class="min-h-screen">

  <!-- NAVBAR -->
  <nav class="glass fixed top-0 w-full z-50 p-4 shadow-2xl">
    <div class="max-w-7xl mx-auto flex justify-between items-center">
      <h1 class="text-3xl font-bold bg-gradient-to-r from-cyan-400 to-purple-600 bg-clip-text text-transparent">AI Hub</h1>
      <div class="flex gap-3">
        <button onclick="show('home')" class="px-5 py-2 rounded-xl glass hover:bg-white/20">Home</button>
        <button onclick="show('hub')" class="px-5 py-2 rounded-xl glass hover:bg-white/20">Hub</button>
        <button onclick="show('dashboard')" id="dashBtn" class="hidden px-5 py-2 rounded-xl bg-gradient-to-r from-purple-500 to-pink-500 text-white">Dashboard</button>
        <button onclick="toggleTheme()" class="p-2 rounded-xl glass"><i class="ti ti-moon"></i></button>
      </div>
    </div>
  </nav>

  <!-- HOME -->
  <div id="home" class="pt-32 pb-20 text-center">
    <div class="max-w-5xl mx-auto px-6">
      <h1 class="text-7xl font-extrabold mb-6 bg-gradient-to-r from-cyan-400 via-purple-500 to-pink-500 bg-clip-text text-transparent animate-pulse">AI‑Powered Script Hub</h1>
      <p class="text-2xl mb-10 text-gray-600 dark:text-gray-300">Generate, Share, & Download Code with Built‑in ChatGPT</p>
      <div id="auth" class="max-w-md mx-auto">
        <input id="email" placeholder="you@aihub.com" class="p-4 rounded-2xl w-full mb-4 glass text-lg" />
        <input id="pass" type="password" placeholder="••••••••" class="p-4 rounded-2xl w-full mb-4 glass text-lg" />
        <button onclick="login()" class="w-full py-4 bg-gradient-to-r from-cyan-500 to-purple-600 text-white rounded-2xl font-bold text-lg shadow-xl hover:shadow-2xl transition">Enter the AI Realm</button>
      </div>
    </div>
  </div>

  <!-- DASHBOARD -->
  <div id="dashboard" class="hidden pt-32 max-w-7xl mx-auto px-6">
    <h2 class="text-5xl font-bold mb-10">Your AI Dashboard</h2>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
      <div class="glass p-8 rounded-3xl card text-center">
        <i class="ti ti-code text-5xl mb-4 text-purple-500"></i>
        <h3 class="text-xl font-semibold">Your Scripts</h3>
        <p class="text-4xl font-bold" id="userCount">0</p>
      </div>
      <div class="glass p-8 rounded-3xl card text-center">
        <i class="ti ti-world text-5xl mb-4 text-cyan-500"></i>
        <h3 class="text-xl font-semibold">Global Scripts</h3>
        <p class="text-4xl font-bold" id="totalCount">0</p>
      </div>
      <div class="glass p-8 rounded-3xl card text-center">
        <i class="ti ti-robot text-5xl mb-4 text-pink-500"></i>
        <h3 class="text-xl font-semibold">AI Chats</h3>
        <p class="text-4xl font-bold" id="chatCount">0</p>
      </div>
    </div>

    <!-- CHATGPT BUILT‑IN -->
    <div class="glass p-6 rounded-3xl mb-8">
      <h3 class="text-2xl font-bold mb-4 flex items-center gap-2"><i class="ti ti-robot"></i> ChatGPT Code Assistant</h3>
      <div id="chat" class="h-80 overflow-y-auto p-4 space-y-3 mb-4"></div>
      <div class="flex gap-2">
        <input id="prompt" placeholder="Ask AI to generate code..." class="flex-1 p-4 rounded-2xl glass" onkeypress="if(event.key==='Enter') askAI()" />
        <button onclick="askAI()" class="px-6 py-4 bg-gradient-to-r from-cyan-500 to-purple-600 text-white rounded-2xl font-bold"><i class="ti ti-send"></i></button>
      </div>
    </div>

    <button onclick="showPost()" class="fixed bottom-10 right-10 w-20 h-20 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-full text-4xl shadow-2xl hover:scale-110 transition flex items-center justify-center">+</button>
  </div>

  <!-- HUB -->
  <div id="hub" class="hidden pt-32 max-w-7xl mx-auto px-6">
    <div class="flex justify-between items-center mb-8">
      <h2 class="text-5xl font-bold">Script Hub</h2>
      <input id="search" placeholder="Search AI‑generated scripts..." class="p-4 rounded-2xl w-96 glass text-lg" onkeyup="filter()" />
    </div>
    <div id="grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
  </div>

  <!-- POST MODAL -->
  <div id="modal" class="hidden fixed inset-0 bg-black/60 flex items-center justify-center z-50">
    <div class="glass p-10 rounded-3xl w-full max-w-2xl card scale-95 transition">
      <h3 class="text-3xl font-bold mb-6">Post AI‑Enhanced Script</h3>
      <input id="title" placeholder="Script Title" class="p-4 rounded-2xl w-full mb-4 glass text-lg" />
      <textarea id="code" placeholder="Paste or generate code..." class="p-4 rounded-2xl w-full h-64 mb-4 glass font-mono text-sm"></textarea>
      <div class="flex gap-4">
        <button onclick="post()" class="flex-1 py-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-2xl font-bold">Post to Hub</button>
        <button onclick="closeModal()" class="flex-1 py-4 bg-gray-600 text-white rounded-2xl">Cancel</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
  <script>
    const API = '/api';
    let token = localStorage.getItem('token') || '';
    let user = '';
    const db = { scripts: [], chats: [] };

    function show(p) {
      ['home','dashboard','hub'].forEach(id => document.getElementById(id).classList.add('hidden'));
      document.getElementById(p).classList.remove('hidden');
      if (p === 'hub') loadHub();
      if (p === 'dashboard') loadDash();
    }

    async function login() {
      const email = document.getElementById('email').value;
      const pass = document.getElementById('pass').value;
      const res = await fetch(API + '/auth', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ email, pass }) });
      const data = await res.json();
      if (data.token) {
        token = data.token; user = email.split('@')[0];
        localStorage.setItem('token', token);
        document.getElementById('auth').innerHTML = `<p class="text-cyan-400 text-xl">Welcome, <strong>${user}</strong>!</p>`;
        document.getElementById('dashBtn').classList.remove('hidden');
        show('dashboard');
      }
    }

    function showPost() {
      document.getElementById('modal').classList.remove('hidden');
      setTimeout(() => document.querySelector('.card').classList.replace('scale-95', 'scale-100'), 10);
    }

    function closeModal() { document.getElementById('modal').classList.add('hidden'); }

    function post() {
      const title = document.getElementById('title').value;
      const code = document.getElementById('code').value;
      if (!title || !code) return;
      db.scripts.push({ title, code, user, date: new Date().toLocaleString(), lang: detectLang(code) });
      closeModal();
      loadHub(); loadDash();
    }

    function detectLang(code) {
      if (code.includes('function') || code.includes('=>')) return 'js';
      if (code.includes('def ') || code.includes('print(')) return 'python';
      return 'txt';
    }

    function loadDash() {
      document.getElementById('userCount').innerText = db.scripts.filter(s => s.user === user).length;
      document.getElementById('totalCount').innerText = db.scripts.length;
      document.getElementById('chatCount').innerText = db.chats.length;
    }

    function loadHub() {
      const g = document.getElementById('grid'); g.innerHTML = '';
      db.scripts.forEach(s => {
        const card = document.createElement('div');
        card.className = 'glass p-6 rounded-3xl card';
        card.innerHTML = `
          <h3 class="text-2xl font-bold mb-2">${s.title}</h3>
          <p class="text-sm opacity-70 mb-4">by <strong>${s.user}</strong> • ${s.date}</p>
          <pre><code class="language-${s.lang}">${Prism.highlight(s.code, Prism.languages[s.lang] || Prism.languages.txt, s.lang)}</code></pre>
          <button onclick="download('${s.title}.txt', \`${s.code}\`)" class="mt-4 px-6 py-3 bg-gradient-to-r from-cyan-500 to-purple-600 text-white rounded-xl text-sm font-bold">Download</button>
        `;
        g.appendChild(card);
      });
    }

    function filter() {
      const term = document.getElementById('search').value.toLowerCase();
      document.querySelectorAll('#grid .card').forEach(c => {
        c.style.display = c.innerText.toLowerCase().includes(term) ? 'block' : 'none';
      });
    }

    function download(name, content) {
      const a = document.createElement('a');
      a.href = URL.createObjectURL(new Blob([content], { type: 'text/plain' }));
      a.download = name; a.click();
    }

    async function askAI() {
      const input = document.getElementById('prompt');
      const prompt = input.value.trim();
      if (!prompt) return;
      addChat('user', prompt);
      input.value = '';
      addChat('ai', '', true); // typing

      // FAKE AI RESPONSE (replace with real OpenAI API key)
      setTimeout(() => {
        const responses = [
          `Here's a Python script:\n\`\`\`python\n${prompt.replace('make', '').trim()} = "AI Generated"\nprint(${prompt.split(' ')[1]})\n\`\`\``,
          `JavaScript version:\n\`\`\`js\n// ${prompt}\nfunction run() { console.log("AI says hi"); }\nrun();\n\`\`\``,
          `HTML + CSS:\n\`\`\`html\n<div class="ai-box">${prompt}</div>\n<style>.ai-box { color: cyan; }</style>\n\`\`\``
        ];
        const code = responses[Math.floor(Math.random() * responses.length)];
        document.getElementById('chat').lastChild.innerHTML = `<div class="chat-bubble ai">${code.replace(/\`\`\`/g, '<pre><code class="language-js">').replace(/\`\`\`/g, '</code></pre>')}</div>`;
        Prism.highlightAll();
        db.chats.push({ user: 'AI', msg: code });
      }, 1500);
    }

    function addChat(sender, msg, typing = false) {
      const chat = document.getElementById('chat');
      const div = document.createElement('div');
      div.className = `chat-bubble ${sender} ${typing ? 'typing' : ''}`;
      div.innerHTML = typing ? '<div class="dot"></div><div class="dot"></div><div class="dot"></div>' : msg;
      chat.appendChild(div);
      chat.scrollTop = chat.scrollHeight;
    }

    function toggleTheme() {
      document.body.classList.toggle('dark');
      localStorage.setItem('dark', document.body.classList.contains('dark'));
    }

    // INIT
    if (localStorage.getItem('dark') === 'true') document.body.classList.add('dark');
    if (token) { user = token.split('-')[2]; document.getElementById('dashBtn').classList.remove('hidden'); show('dashboard'); }
  </script>
</body>
</html>
